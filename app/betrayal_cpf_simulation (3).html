<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ£Ø«ÙŠØ± Ø§Ù„Ø®ÙŠØ§Ù†Ø© Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ© Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… CPF</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap');
        body { font-family: 'Cairo', sans-serif; }
        
        .corrupted {
            animation: heartbreak-glitch 2s infinite;
            filter: hue-rotate(180deg) contrast(1.8) brightness(0.7);
        }
        
        .doubtful {
            animation: doubt-pulse 1.5s infinite;
            opacity: 0.6;
        }
        
        @keyframes heartbreak-glitch {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-3px) scaleX(0.95); }
            40% { transform: translateX(3px) scaleY(0.95); }
            60% { transform: translateX(-2px) scaleX(1.05); }
            80% { transform: translateX(2px) scaleY(1.05); }
        }
        
        @keyframes doubt-pulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(0.95); }
        }
        
        .heart-broken {
            animation: broken-heart 3s infinite;
        }
        
        @keyframes broken-heart {
            0%, 100% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(-2deg) scale(0.98); }
            50% { transform: rotate(2deg) scale(1.02); }
            75% { transform: rotate(-1deg) scale(0.99); }
        }
        
        .corrupted-memory {
            background: linear-gradient(45deg, #dc2626, #ef4444, #1f2937, #dc2626);
            background-size: 400% 400%;
            animation: betrayal-gradient 2s ease infinite;
        }
        
        @keyframes betrayal-gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .love-memory {
            background: linear-gradient(45deg, #ec4899, #f97316, #84cc16);
            background-size: 200% 200%;
            animation: love-gradient 4s ease infinite;
        }
        
        @keyframes love-gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .simulator-card {
            transition: all 0.3s ease;
        }
        
        .simulator-card:hover {
            transform: translateY(-2px) scale(1.02);
        }
        
        .trust-broken {
            filter: brightness(0.3) saturate(0.2);
            border: 2px dashed #ef4444 !important;
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
        }
        
        .relationship-healthy {
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.3);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-pink-900 to-slate-900 min-h-screen text-white" x-data="betrayalSimulation">
    
    <!-- Header -->
    <header class="text-center py-6 border-b border-gray-700">
        <h1 class="text-3xl font-bold mb-2">ğŸ’”ğŸ’• ØªØ£Ø«ÙŠØ± Ø§Ù„Ø®ÙŠØ§Ù†Ø© Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ© Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… CPF</h1>
        <p class="text-gray-300">Ù…Ø­Ø§ÙƒØ§Ø©: ÙƒÙŠÙ ØªØ¯Ù…Ø± Ø§Ù„Ø®ÙŠØ§Ù†Ø© Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ© Ø¥Ø¯Ø±Ø§ÙƒÙ†Ø§ ÙˆØ°Ø§ÙƒØ±ØªÙ†Ø§ ÙˆØ«Ù‚ØªÙ†Ø§</p>
        <div class="mt-4 text-6xl" :class="betrayalActive ? 'heart-broken' : ''" x-text="betrayalActive ? 'ğŸ’”' : 'ğŸ’•'"></div>
    </header>

    <!-- Control Panel -->
    <div class="container mx-auto px-4 py-6">
        <div class="bg-gray-800 rounded-lg p-6 mb-6" :class="betrayalActive ? 'trust-broken' : 'relationship-healthy'">
            <h3 class="text-xl font-semibold mb-4">ğŸ® Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <button @click="simulateRomance()" 
                        class="bg-pink-600 hover:bg-pink-700 px-4 py-2 rounded transition-colors">
                    ğŸ’• Ù„Ø­Ø¸Ø© Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ©
                </button>
                <button @click="simulateDoubt()" 
                        class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded transition-colors">
                    ğŸ¤” Ø´Ùƒ ÙˆØ±ÙŠØ¨Ø©
                </button>
                <button @click="simulateBetrayal()" 
                        class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded transition-colors">
                    ğŸ’” Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø®ÙŠØ§Ù†Ø©!
                </button>
                <button @click="reset()" 
                        class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded transition-colors">
                    ğŸ”„ Ø¹Ù„Ø§Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©
                </button>
            </div>
        </div>

        <!-- Relationship Status -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-6">
            
            <!-- Trust Matrix -->
            <div class="bg-gray-800 rounded-lg p-6" :class="{ 'trust-broken': betrayalActive }">
                <h3 class="text-lg font-semibold mb-4 flex items-center">
                    ğŸ” Ù…ØµÙÙˆÙØ© Ø§Ù„Ø«Ù‚Ø©
                    <span class="mr-2 text-sm" :class="trustLevel >= 0.7 ? 'text-green-400' : trustLevel >= 0.4 ? 'text-yellow-400' : 'text-red-400'">
                        (<span x-text="Math.round(trustLevel * 100)"></span>%)
                    </span>
                </h3>
                
                <div class="space-y-3">
                    <div class="flex justify-between items-center">
                        <span>Ø§Ù„Ø´Ø±ÙŠÙƒ Ø§Ù„Ø¹Ø§Ø·ÙÙŠ</span>
                        <div class="w-20 bg-gray-700 rounded-full h-2">
                            <div class="h-2 rounded-full transition-all duration-1000" 
                                 :style="`width: ${partnerTrust * 100}%`"
                                 :class="betrayalActive ? 'corrupted-memory' : 'love-memory'"></div>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>Ø§Ù„Ø°ÙƒØ±ÙŠØ§Øª Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©</span>
                        <div class="w-20 bg-gray-700 rounded-full h-2">
                            <div class="h-2 rounded-full transition-all duration-1000" 
                                 :style="`width: ${memoryTrust * 100}%`"
                                 :class="{ 'corrupted-memory': betrayalActive && memoryTrust < 0.3, 'love-memory': !betrayalActive }"></div>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>Ø§Ù„Ø«Ù‚Ø© ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</span>
                        <div class="w-20 bg-gray-700 rounded-full h-2">
                            <div class="h-2 rounded-full transition-all duration-1000" 
                                 :style="`width: ${futureTrust * 100}%`"
                                 :class="{ 'corrupted-memory': betrayalActive && futureTrust < 0.3, 'love-memory': !betrayalActive }"></div>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>Ø§Ù„Ø«Ù‚Ø© ÙÙŠ Ø§Ù„Ø°Ø§Øª</span>
                        <div class="w-20 bg-gray-700 rounded-full h-2">
                            <div class="h-2 rounded-full transition-all duration-1000" 
                                 :style="`width: ${selfTrust * 100}%`"
                                 :class="{ 'corrupted-memory': betrayalActive && selfTrust < 0.3, 'love-memory': !betrayalActive }"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Middleware Bridge -->
            <div class="bg-gray-800 rounded-lg p-6">
                <h3 class="text-lg font-semibold mb-4">ğŸŒ‰ Ø§Ù„Ø¬Ø³Ø± Ø§Ù„Ø¥Ø¯Ø±Ø§ÙƒÙŠ</h3>
                <div class="text-center">
                    <div class="w-16 h-16 mx-auto mb-3 rounded-full flex items-center justify-center text-2xl transition-all duration-500"
                         :class="middlewareState === 'filtering' ? 'bg-green-600 animate-pulse' : 
                                middlewareState === 'blocking' ? 'bg-red-600 corrupted' : 
                                middlewareState === 'paranoid' ? 'bg-orange-600 doubtful' :
                                'bg-yellow-600 doubtful'">
                        <span x-text="middlewareState === 'filtering' ? 'ğŸ’•' : 
                                     middlewareState === 'blocking' ? 'ğŸš«' : 
                                     middlewareState === 'paranoid' ? 'ğŸ‘ï¸' : 'â“'"></span>
                    </div>
                    <p class="text-sm" x-text="middlewareState === 'filtering' ? 'ÙŠØ±Ø´Ø­ Ø¨Ù…Ø­Ø¨Ø©' : 
                                              middlewareState === 'blocking' ? 'ÙŠØ­Ø¬Ø¨ ÙƒÙ„ Ø´ÙŠØ¡!' : 
                                              middlewareState === 'paranoid' ? 'Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…ÙØ±Ø·Ø©' :
                                              'ÙŠØ´Ùƒ ÙÙŠ ÙƒÙ„ Ø´ÙŠØ¡'"></p>
                </div>
            </div>

            <!-- Emotional State -->
            <div class="bg-gray-800 rounded-lg p-6">
                <h3 class="text-lg font-semibold mb-4">ğŸ’– Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ©</h3>
                <div class="text-center">
                    <div class="text-3xl font-bold mb-2" :class="betrayalActive ? 'text-red-400 doubtful' : 'text-pink-400'">
                        <span x-text="emotionalHealth"></span>%
                    </div>
                    <div class="w-full bg-gray-700 rounded-full h-4">
                        <div class="h-4 rounded-full transition-all duration-1000"
                             :style="`width: ${emotionalHealth}%`"
                             :class="betrayalActive ? 'corrupted-memory' : 'love-memory'"></div>
                    </div>
                    <p class="text-xs mt-2 text-gray-400" x-text="betrayalActive ? 'Ù‚Ù„Ø¨ Ù…Ø­Ø·Ù…' : 'Ù‚Ù„Ø¨ ÙŠÙ†Ø¨Ø¶ Ø¨Ø§Ù„Ø­Ø¨'"></p>
                </div>
            </div>

            <!-- Self Copies Model -->
            <div class="bg-gray-800 rounded-lg p-6">
                <h3 class="text-lg font-semibold mb-4">ğŸª Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø°Ø§Øª</h3>
                <div class="text-center">
                    <div class="text-xl mb-2" x-text="selfImage"></div>
                    <div class="text-sm text-gray-400" x-text="selfImageDescription"></div>
                    <div class="mt-3 text-xs">
                        <span x-text="betrayalActive ? 'Ù‡Ù„ Ø£Ø³ØªØ­Ù‚ Ø§Ù„Ø­Ø¨ØŸ' : 'Ø£Ù†Ø§ Ù…Ø­Ø¨ÙˆØ¨ ÙˆÙ…Ù‚Ø¯Ø±'"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Simulators Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
            <template x-for="simulator in simulators" :key="simulator.id">
                <div class="simulator-card bg-gray-800 rounded-lg p-4 border-2 transition-all duration-500"
                     :class="simulator.corrupted ? 'border-red-500 corrupted-memory' : 
                             simulator.doubtful ? 'border-yellow-500 doubtful' : 
                             'border-gray-600'">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-sm" x-text="simulator.name"></h4>
                        <span class="text-lg" x-text="simulator.icon"></span>
                    </div>
                    <div class="text-xs text-gray-300 mb-2" x-text="simulator.status"></div>
                    <div class="w-full bg-gray-700 rounded-full h-2">
                        <div class="h-2 rounded-full transition-all duration-1000"
                             :style="`width: ${simulator.confidence * 100}%`"
                             :class="simulator.corrupted ? 'bg-red-500 corrupted' : 
                                    simulator.doubtful ? 'bg-yellow-500 doubtful' : 
                                    'bg-pink-500'"></div>
                    </div>
                </div>
            </template>
        </div>

        <!-- Agate Memory Timeline -->
        <div class="bg-gray-800 rounded-lg p-6 mb-6">
            <h3 class="text-xl font-semibold mb-4">ğŸ’ Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¹Ù‚ÙŠÙ‚ - Ø§Ù„Ø®Ø· Ø§Ù„Ø²Ù…Ù†ÙŠ Ø§Ù„Ø¹Ø§Ø·ÙÙŠ</h3>
            <div class="flex flex-wrap gap-2 mb-4">
                <template x-for="(agate, index) in agateTimeline" :key="index">
                    <div class="w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-500 cursor-pointer"
                         :class="agate.corrupted ? 'bg-red-800 text-red-200 corrupted border-2 border-red-400' :
                                agate.doubtful ? 'bg-yellow-800 text-yellow-200 doubtful border-2 border-yellow-400' :
                                agate.color === 'white' ? 'bg-gray-300 text-gray-800' :
                                agate.color === 'pink' ? 'bg-pink-600 text-white' :
                                agate.color === 'red' ? 'bg-red-600 text-white' :
                                agate.color === 'purple' ? 'bg-purple-600 text-white' :
                                agate.color === 'blue' ? 'bg-blue-600 text-white' :
                                agate.color === 'yellow' ? 'bg-yellow-600 text-white' :
                                'bg-green-600 text-white'"
                         @click="showAgateDetails(agate)"
                         :title="agate.description">
                        <span x-text="agate.corrupted ? 'ğŸ’€' : agate.doubtful ? 'â“' : agate.emoji"></span>
                    </div>
                </template>
            </div>
            <div class="text-sm text-gray-400">
                <span>ğŸ’• Ø°ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø­Ø¨</span> â€¢ 
                <span>ğŸ’” Ø°ÙƒØ±ÙŠØ§Øª Ù…Ù„ÙˆØ«Ø©</span> â€¢ 
                <span>â“ Ø°ÙƒØ±ÙŠØ§Øª Ù…Ø´ÙƒÙˆÙƒ ÙÙŠÙ‡Ø§</span> â€¢ 
                <span>âšª Ù„Ø­Ø¸Ø§Øª ØºÙŠØ± Ù…Ø­Ø³ÙˆÙ…Ø©</span>
            </div>
        </div>

        <!-- Events Log -->
        <div class="bg-gray-800 rounded-lg p-6">
            <h3 class="text-xl font-semibold mb-4">ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ©</h3>
            <div class="max-h-40 overflow-y-auto space-y-2">
                <template x-for="(event, index) in events" :key="index">
                    <div class="text-sm p-2 rounded"
                         :class="event.type === 'betrayal' ? 'bg-red-900 text-red-200' :
                                event.type === 'doubt' ? 'bg-yellow-900 text-yellow-200' :
                                event.type === 'corruption' ? 'bg-purple-900 text-purple-200' :
                                event.type === 'romance' ? 'bg-pink-900 text-pink-200' :
                                'bg-green-900 text-green-200'">
                        <span class="text-xs text-gray-400" x-text="event.time"></span> - 
                        <span x-text="event.message"></span>
                    </div>
                </template>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('betrayalSimulation', () => ({
                // Trust Matrix Values
                trustLevel: 0.9,
                partnerTrust: 0.9,
                memoryTrust: 0.9,
                futureTrust: 0.8,
                selfTrust: 0.8,
                
                // Emotional States
                betrayalActive: false,
                doubtPhase: false,
                emotionalHealth: 85,
                selfImage: 'ğŸ˜Š ÙˆØ§Ø«Ù‚ ÙˆÙ…Ø­Ø¨ÙˆØ¨',
                selfImageDescription: 'Ø£Ø±Ù‰ Ù†ÙØ³ÙŠ Ø¬Ø°Ø§Ø¨Ø§Ù‹ ÙˆÙ…Ø³ØªØ­Ù‚Ø§Ù‹ Ù„Ù„Ø­Ø¨',
                middlewareState: 'filtering', // filtering, blocking, doubtful, paranoid
                
                // Simulators
                simulators: [
                    { id: 1, name: 'Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„ÙˆØ§Ù‚Ø¹', icon: 'ğŸ‘ï¸', confidence: 0.9, status: 'ÙŠØ±Ù‰ Ø§Ù„Ø­Ø¨ ÙÙŠ ÙƒÙ„ Ù…ÙƒØ§Ù†', corrupted: false, doubtful: false },
                    { id: 2, name: 'Ù…Ø­Ø±Ùƒ Ø§Ù„ØªÙ†Ø¨Ø¤', icon: 'ğŸ”®', confidence: 0.8, status: 'ÙŠØªÙˆÙ‚Ø¹ Ù…Ø³ØªÙ‚Ø¨Ù„ Ø³Ø¹ÙŠØ¯', corrupted: false, doubtful: false },
                    { id: 3, name: 'Ù…ÙØ¹ÙŠØ¯ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø°Ø§ÙƒØ±Ø©', icon: 'ğŸ§ ', confidence: 0.9, status: 'ÙŠØ³ØªØ¯Ø¹ÙŠ Ø°ÙƒØ±ÙŠØ§Øª Ø¬Ù…ÙŠÙ„Ø©', corrupted: false, doubtful: false },
                    { id: 4, name: 'Ù†Ù…ÙˆØ°Ø¬ Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ', icon: 'ğŸ‘¥', confidence: 0.7, status: 'ÙŠØ«Ù‚ ÙÙŠ Ø§Ù„Ù†ÙˆØ§ÙŠØ§', corrupted: false, doubtful: false },
                    { id: 5, name: 'Ù…Ø³ØªÙƒØ´Ù Ø§Ù„Ø£Ù†Ù…Ø§Ø·', icon: 'ğŸ”', confidence: 0.8, status: 'ÙŠØ±Ù‰ Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø­Ø¨', corrupted: false, doubtful: false },
                    { id: 6, name: 'Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø¹ÙˆØ§Ø·Ù', icon: 'ğŸ’', confidence: 0.9, status: 'ÙŠØ±Ø§Ù‚Ø¨ Ù…Ø´Ø§Ø¹Ø± Ø§Ù„Ø­Ø¨', corrupted: false, doubtful: false }
                ],
                
                // Agate Memory Timeline
                agateTimeline: [
                    { color: 'pink', emoji: 'ğŸ’•', description: 'Ø£ÙˆÙ„ Ù„Ù‚Ø§Ø¡ - Ø³Ø­Ø± Ù…Ù† Ø£ÙˆÙ„ Ù†Ø¸Ø±Ø©', corrupted: false, doubtful: false },
                    { color: 'purple', emoji: 'ğŸ’œ', description: 'Ù‚Ø¶Ø§Ø¡ ÙˆÙ‚Øª Ø¬Ù…ÙŠÙ„ Ù…Ø¹Ø§Ù‹', corrupted: false, doubtful: false },
                    { color: 'red', emoji: 'â¤ï¸', description: 'ÙƒÙ„Ù…Ø§Øª Ø­Ø¨ Ø¹Ù…ÙŠÙ‚Ø©', corrupted: false, doubtful: false },
                    { color: 'pink', emoji: 'ğŸ’•', description: 'Ø®Ø·Ø· Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„', corrupted: false, doubtful: false },
                    { color: 'yellow', emoji: 'ğŸŒŸ', description: 'Ù„Ø­Ø¸Ø© Ø³Ø¹Ø§Ø¯Ø© Ù…Ø·Ù„Ù‚Ø©', corrupted: false, doubtful: false },
                    { color: 'white', emoji: 'ğŸ¤', description: 'Ù„Ø­Ø¸Ø© ØºØ§Ù…Ø¶Ø©', corrupted: false, doubtful: false }
                ],
                
                // Events Log
                events: [
                    { time: '09:00', message: 'ğŸ’• Ø¨Ø¯Ø§ÙŠØ© ÙŠÙˆÙ… Ø¬Ù…ÙŠÙ„ Ù…Ø¹ Ù…Ù† Ù†Ø­Ø¨', type: 'romance' },
                    { time: '09:30', message: 'ğŸŒ¸ Ø±Ø³Ø§Ù„Ø© Ø­Ø¨ ØµØ¨Ø§Ø­ÙŠØ©', type: 'romance' }
                ],
                
                // Methods
                simulateRomance() {
                    if (!this.betrayalActive) {
                        this.addEvent('ğŸ’• Ù„Ø­Ø¸Ø© Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ© Ø¬Ù…ÙŠÙ„Ø© - ØªÙ‚ÙˆÙŠØ© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·', 'romance');
                        
                        // ØªØ­Ø³Ù† ÙÙŠ ÙƒÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠÙŠØ³
                        this.partnerTrust = Math.min(1, this.partnerTrust + 0.05);
                        this.memoryTrust = Math.min(1, this.memoryTrust + 0.03);
                        this.emotionalHealth = Math.min(100, this.emotionalHealth + 5);
                        this.updateTrustLevel();
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ø§ÙƒÙŠØ§Øª
                        this.simulators.forEach(sim => {
                            sim.confidence = Math.min(1, sim.confidence + 0.05);
                            sim.status = sim.name.includes('Ù…Ø¹Ø§Ù„Ø¬') ? 'ÙŠØ±Ù‰ Ø§Ù„Ø­Ø¨ ÙÙŠ ÙƒÙ„ Ù…ÙƒØ§Ù†' :
                                        sim.name.includes('Ù…Ø­Ø±Ùƒ') ? 'ÙŠØªÙˆÙ‚Ø¹ Ù…Ø³ØªÙ‚Ø¨Ù„ Ø³Ø¹ÙŠØ¯' :
                                        sim.name.includes('Ø°Ø§ÙƒØ±Ø©') ? 'ÙŠØ³ØªØ¯Ø¹ÙŠ Ø°ÙƒØ±ÙŠØ§Øª Ø¬Ù…ÙŠÙ„Ø©' :
                                        sim.name.includes('Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ') ? 'ÙŠØ«Ù‚ ÙÙŠ Ø§Ù„Ù†ÙˆØ§ÙŠØ§' :
                                        sim.name.includes('Ø£Ù†Ù…Ø§Ø·') ? 'ÙŠØ±Ù‰ Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø­Ø¨' :
                                        'ÙŠØ±Ø§Ù‚Ø¨ Ù…Ø´Ø§Ø¹Ø± Ø§Ù„Ø­Ø¨';
                        });
                        
                        // Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚ÙŠÙ‚ Ø­Ø¨ Ø¬Ø¯ÙŠØ¯
                        const loveColors = ['pink', 'purple', 'red'];
                        const loveEmojis = ['ğŸ’•', 'ğŸ’œ', 'â¤ï¸'];
                        const colorIndex = Math.floor(Math.random() * loveColors.length);
                        
                        this.agateTimeline.push({
                            color: loveColors[colorIndex],
                            emoji: loveEmojis[colorIndex],
                            description: 'Ù„Ø­Ø¸Ø© Ø­Ø¨ Ø¬Ø¯ÙŠØ¯Ø©',
                            corrupted: false,
                            doubtful: false
                        });
                    } else {
                        // Ø¨Ø¹Ø¯ Ø§Ù„Ø®ÙŠØ§Ù†Ø© - Ø­ØªÙ‰ Ø§Ù„Ù„Ø­Ø¸Ø§Øª Ø§Ù„Ø¬Ù…ÙŠÙ„Ø© Ù…Ø´ÙƒÙˆÙƒ ÙÙŠÙ‡Ø§
                        this.addEvent('ğŸ’” Ø­ØªÙ‰ Ø§Ù„Ù„Ø­Ø¸Ø§Øª Ø§Ù„Ø¬Ù…ÙŠÙ„Ø© Ø£ØµØ¨Ø­Øª Ù…Ø´ÙƒÙˆÙƒ ÙÙŠÙ‡Ø§', 'doubt');
                        this.agateTimeline.push({
                            color: 'white',
                            emoji: 'â“',
                            description: 'Ù„Ø­Ø¸Ø© Ù…Ø´ÙƒÙˆÙƒ ÙÙŠ ØµØ¯Ù‚Ù‡Ø§',
                            corrupted: false,
                            doubtful: true
                        });
                    }
                },
                
                simulateDoubt() {
                    this.doubtPhase = true;
                    this.addEvent('ğŸ¤” Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø´Ùƒ - Ø´ÙŠØ¡ Ù…Ø§ Ù„ÙŠØ³ Ø¹Ù„Ù‰ Ù…Ø§ ÙŠØ±Ø§Ù…', 'doubt');
                    
                    // Ø§Ù†Ø®ÙØ§Ø¶ Ø·ÙÙŠÙ ÙÙŠ Ø§Ù„Ø«Ù‚Ø©
                    this.partnerTrust = Math.max(0.3, this.partnerTrust - 0.2);
                    this.futureTrust = Math.max(0.4, this.futureTrust - 0.15);
                    this.updateTrustLevel();
                    
                    // ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Middleware
                    this.middlewareState = 'doubtful';
                    
                    // Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø­Ø§ÙƒÙŠØ§Øª ØªØµØ¨Ø­ Ù…Ø´ÙƒÙˆÙƒ ÙÙŠÙ‡Ø§
                    this.simulators.forEach((sim, index) => {
                        if (index < 3) { // Ø£ÙˆÙ„ 3 Ù…Ø­Ø§ÙƒÙŠØ§Øª
                            sim.doubtful = true;
                            sim.confidence = Math.max(0.4, sim.confidence - 0.3);
                            sim.status = 'ÙŠØ¨Ø­Ø« Ø¹Ù† Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø®Ø·Ø±';
                        }
                    });
                    
                    // Ø¥ÙØ³Ø§Ø¯ Ø¨Ø¹Ø¶ Ø°ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø¹Ù‚ÙŠÙ‚
                    this.agateTimeline.forEach(agate => {
                        if (agate.color === 'white' || Math.random() > 0.7) {
                            agate.doubtful = true;
                            if (agate.color === 'white') {
                                agate.description = 'Ù„Ø­Ø¸Ø© Ù…Ø´ÙƒÙˆÙƒ ÙÙŠÙ‡Ø§ - Ù…Ø§Ø°Ø§ Ø­Ø¯Ø« Ø­Ù‚Ø§Ù‹ØŸ';
                            }
                        }
                    });
                    
                    setTimeout(() => {
                        this.middlewareState = 'paranoid';
                        this.addEvent('ğŸ‘ï¸ Ø¯Ø®ÙˆÙ„ ÙÙŠ Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…ÙØ±Ø·Ø©', 'doubt');
                    }, 2000);
                },
                
                simulateBetrayal() {
                    this.betrayalActive = true;
                    this.doubtPhase = false;
                    this.addEvent('ğŸ’”ğŸ’”ğŸ’” Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø®ÙŠØ§Ù†Ø©! ØªØ¯Ù…ÙŠØ± ÙƒØ§Ù…Ù„ Ù„Ù„Ø«Ù‚Ø©', 'betrayal');
                    
                    // Ø§Ù†Ù‡ÙŠØ§Ø± ÙÙˆØ±ÙŠ ÙÙŠ ÙƒÙ„ Ø´ÙŠØ¡
                    this.partnerTrust = 0.05;
                    this.memoryTrust = 0.1;
                    this.futureTrust = 0.1;
                    this.selfTrust = 0.3;
                    this.emotionalHealth = 15;
                    this.updateTrustLevel();
                    
                    // ØªØºÙŠÙŠØ± ØµÙˆØ±Ø© Ø§Ù„Ø°Ø§Øª
                    this.selfImage = 'ğŸ˜­ Ù…Ø­Ø·Ù… ÙˆØºÙŠØ± Ù…Ø±ØºÙˆØ¨';
                    this.selfImageDescription = 'Ø±Ø¨Ù…Ø§ Ù„Ø§ Ø£Ø³ØªØ­Ù‚ Ø§Ù„Ø­Ø¨... Ù…Ø§Ø°Ø§ Ø¨ÙŠØŸ';
                    
                    // ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Middleware
                    this.middlewareState = 'blocking';
                    
                    setTimeout(() => {
                        this.addEvent('ğŸ§  ØªÙ„ÙˆÙŠØ« Ø´Ø§Ù…Ù„ Ù„Ù„Ø°ÙƒØ±ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø­Ø§ÙƒÙŠØ§Øª', 'corruption');
                        
                        // Ø¥ÙØ³Ø§Ø¯ ÙƒÙ„ Ø§Ù„Ù…Ø­Ø§ÙƒÙŠØ§Øª
                        this.simulators.forEach(sim => {
                            sim.corrupted = true;
                            sim.doubtful = false;
                            sim.confidence = Math.random() * 0.3 + 0.1;
                            sim.status = sim.name.includes('Ù…Ø¹Ø§Ù„Ø¬') ? 'ÙŠØ±Ù‰ Ø§Ù„Ø®ÙŠØ§Ù†Ø© ÙÙŠ ÙƒÙ„ Ù…ÙƒØ§Ù†' :
                                        sim.name.includes('Ù…Ø­Ø±Ùƒ') ? 'ÙŠØªÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ù„Ù…' :
                                        sim.name.includes('Ø°Ø§ÙƒØ±Ø©') ? 'ÙŠØ³ØªØ¯Ø¹ÙŠ Ø°ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø£Ù„Ù… ÙÙ‚Ø·' :
                                        sim.name.includes('Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ') ? 'Ù„Ø§ ÙŠØ«Ù‚ ÙÙŠ Ø£Ø­Ø¯' :
                                        sim.name.includes('Ø£Ù†Ù…Ø§Ø·') ? 'ÙŠØ±Ù‰ Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø®Ø·Ø± ÙÙ‚Ø·' :
                                        'ÙŠØ±Ø§Ù‚Ø¨ Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø®ÙŠØ§Ù†Ø©';
                        });
                        
                        // ØªÙ„ÙˆÙŠØ« Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¹Ù‚ÙŠÙ‚
                        this.agateTimeline.forEach(agate => {
                            if (agate.color === 'pink' || agate.color === 'purple' || agate.color === 'red') {
                                if (Math.random() > 0.3) {
                                    agate.corrupted = true;
                                    agate.description += ' (Ù‡Ù„ ÙƒØ§Ù† ÙƒÙ„Ù‡ ÙƒØ°Ø¨ØŸ)';
                                    agate.emoji = 'ğŸ’€';
                                }
                            } else if (agate.color === 'white') {
                                agate.doubtful = true;
                                agate.description = 'Ù„Ø­Ø¸Ø© Ù…Ø´ÙƒÙˆÙƒ ÙÙŠÙ‡Ø§ - Ø±Ø¨Ù…Ø§ ÙƒØ§Ù† ÙŠØ®ÙˆÙ†Ù†ÙŠ Ø­ØªÙ‰ Ù‡Ù†Ø§';
                                agate.emoji = 'â“';
                            }
                        });
                        
                        this.addEvent('ğŸ’­ Ø­ØªÙ‰ Ø£Ø¬Ù…Ù„ Ø§Ù„Ø°ÙƒØ±ÙŠØ§Øª Ø£ØµØ¨Ø­Øª Ù…Ù„ÙˆØ«Ø© Ø¨Ø§Ù„Ø´Ùƒ', 'corruption');
                        
                    }, 1500);
                    
                    setTimeout(() => {
                        this.middlewareState = 'paranoid';
                        this.addEvent('ğŸ‘ï¸ Ø§Ù„Ù†Ø¸Ø§Ù… ÙÙŠ Ø­Ø§Ù„Ø© Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…ÙØ±Ø·Ø© Ø¯Ø§Ø¦Ù…Ø©', 'corruption');
                    }, 3000);
                },
                
                reset() {
                    this.betrayalActive = false;
                    this.doubtPhase = false;
                    this.partnerTrust = 0.9;
                    this.memoryTrust = 0.9;
                    this.futureTrust = 0.8;
                    this.selfTrust = 0.8;
                    this.emotionalHealth = 85;
                    this.updateTrustLevel();
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ØµÙˆØ±Ø© Ø§Ù„Ø°Ø§Øª
                    this.selfImage = 'ğŸ˜Š ÙˆØ§Ø«Ù‚ ÙˆÙ…Ø­Ø¨ÙˆØ¨';
                    this.selfImageDescription = 'Ø£Ø±Ù‰ Ù†ÙØ³ÙŠ Ø¬Ø°Ø§Ø¨Ø§Ù‹ ÙˆÙ…Ø³ØªØ­Ù‚Ø§Ù‹ Ù„Ù„Ø­Ø¨';
                    this.middlewareState = 'filtering';
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø­Ø§ÙƒÙŠØ§Øª
                    this.simulators.forEach((sim, index) => {
                        sim.corrupted = false;
                        sim.doubtful = false;
                        sim.confidence = 0.8 + Math.random() * 0.2;
                        sim.status = sim.name.includes('Ù…Ø¹Ø§Ù„Ø¬') ? 'ÙŠØ±Ù‰ Ø§Ù„Ø­Ø¨ ÙÙŠ ÙƒÙ„ Ù…ÙƒØ§Ù†' :
                                    sim.name.includes('Ù…Ø­Ø±Ùƒ') ? 'ÙŠØªÙˆÙ‚Ø¹ Ù…Ø³ØªÙ‚Ø¨Ù„ Ø³Ø¹ÙŠØ¯' :
                                    sim.name.includes('Ø°Ø§ÙƒØ±Ø©') ? 'ÙŠØ³ØªØ¯Ø¹ÙŠ Ø°ÙƒØ±ÙŠØ§Øª Ø¬Ù…ÙŠÙ„Ø©' :
                                    sim.name.includes('Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ') ? 'ÙŠØ«Ù‚ ÙÙŠ Ø§Ù„Ù†ÙˆØ§ÙŠØ§' :
                                    sim.name.includes('Ø£Ù†Ù…Ø§Ø·') ? 'ÙŠØ±Ù‰ Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø­Ø¨' :
                                    'ÙŠØ±Ø§Ù‚Ø¨ Ù…Ø´Ø§Ø¹Ø± Ø§Ù„Ø­Ø¨';
                    });
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¹Ù‚ÙŠÙ‚
                    this.agateTimeline = [
                        { color: 'pink', emoji: 'ğŸ’•', description: 'Ø£ÙˆÙ„ Ù„Ù‚Ø§Ø¡ - Ø³Ø­Ø± Ù…Ù† Ø£ÙˆÙ„ Ù†Ø¸Ø±Ø©', corrupted: false, doubtful: false },
                        { color: 'purple', emoji: 'ğŸ’œ', description: 'Ù‚Ø¶Ø§Ø¡ ÙˆÙ‚Øª Ø¬Ù…ÙŠÙ„ Ù…Ø¹Ø§Ù‹', corrupted: false, doubtful: false },
                        { color: 'red', emoji: 'â¤ï¸', description: 'ÙƒÙ„Ù…Ø§Øª Ø­Ø¨ Ø¹Ù…ÙŠÙ‚Ø©', corrupted: false, doubtful: false },
                        { color: 'pink', emoji: 'ğŸ’•', description: 'Ø®Ø·Ø· Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„', corrupted: false, doubtful: false },
                        { color: 'yellow', emoji: 'ğŸŒŸ', description: 'Ù„Ø­Ø¸Ø© Ø³Ø¹Ø§Ø¯Ø© Ù…Ø·Ù„Ù‚Ø©', corrupted: false, doubtful: false },
                        { color: 'white', emoji: 'ğŸ¤', description: 'Ù„Ø­Ø¸Ø© ØºØ§Ù…Ø¶Ø©', corrupted: false, doubtful: false }
                    ];
                    
                    this.events = [
                        { time: this.getCurrentTime(), message: 'ğŸŒ… Ø¨Ø¯Ø§ÙŠØ© Ø¹Ù„Ø§Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù„ÙŠØ¦Ø© Ø¨Ø§Ù„Ø£Ù…Ù„', type: 'romance' }
                    ];
                },
                
                updateTrustLevel() {
                    this.trustLevel = (this.partnerTrust + this.memoryTrust + this.futureTrust + this.selfTrust) / 4;
                },
                
                addEvent(message, type) {
                    this.events.unshift({
                        time: this.getCurrentTime(),
                        message: message,
                        type: type
                    });
                    
                    if (this.events.length > 12) {
                        this.events.pop();
                    }
                },
                
                getCurrentTime() {
                    return new Date().toLocaleTimeString('ar', { 
                        hour: '2-digit', 
                        minute: '2-digit',
                        second: '2-digit'
                    });
                },
                
                showAgateDetails(agate) {
                    const statusText = agate.corrupted ? 'Ø°ÙƒØ±Ù‰ Ù…Ù„ÙˆØ«Ø© Ø¨Ø§Ù„Ø®ÙŠØ§Ù†Ø© - Ù‡Ù„ ÙƒØ§Ù† ÙƒÙ„Ù‡ ÙƒØ°Ø¨ØŸ' : 
                                      agate.doubtful ? 'Ø°ÙƒØ±Ù‰ Ù…Ø´ÙƒÙˆÙƒ ÙÙŠ ØµØ¯Ù‚Ù‡Ø§' : 
                                      'Ø°ÙƒØ±Ù‰ Ø³Ù„ÙŠÙ…Ø© ÙˆØ¬Ù…ÙŠÙ„Ø©';
                                      
                    const emotionalImpact = agate.corrupted ? 'ØªØ³Ø¨Ø¨ Ø£Ù„Ù… Ø´Ø¯ÙŠØ¯ Ø¹Ù†Ø¯ Ø§Ù„ØªØ°ÙƒØ±' :
                                           agate.doubtful ? 'ØªØ«ÙŠØ± Ø§Ù„Ù‚Ù„Ù‚ ÙˆØ§Ù„Ø´Ùƒ' :
                                           'ØªØ¨Ø¹Ø« Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¹Ø§Ø¯Ø© ÙˆØ§Ù„Ø¯ÙØ¡';
                                           
                    alert(`ğŸ’ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù‚ÙŠÙ‚ Ø§Ù„Ø¹Ø§Ø·ÙÙŠ:\n\n${agate.emoji} ${agate.description}\n\nğŸ“Š Ø§Ù„Ø­Ø§Ù„Ø©: ${statusText}\n\nğŸ’­ Ø§Ù„ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¹Ø§Ø·ÙÙŠ: ${emotionalImpact}`);
                }
            }))
        })
    </script>
                    